# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=py-hypothesis
pkgver=4.14.3
pkgrel=0
pkgdesc="Advanced property-based (QuickCheck-like) testing for Python"
url="http://hypothesis.works/"
arch="noarch"
license="MPL-2.0"
depends="py-coverage"
_py2_deps="py2-coverage"
_py3_deps="py3-coverage"
makedepends="
	$_py2_deps $_py3_deps python2-dev python3-dev py2-setuptools py3-setuptools
	py-enum34
"
subpackages="py2-hypothesis:_py py3-hypothesis:_py"
source="py-hypothesis-$pkgver.tar.gz::https://github.com/HypothesisWorks/hypothesis-python/archive/hypothesis-python-$pkgver.tar.gz"
builddir="$srcdir/hypothesis-hypothesis-python-$pkgver/hypothesis-python"

build() {
	cd "$builddir"
	python2 setup.py build
	python3 setup.py build
}

check() {
	cd "$builddir"
	python2 setup.py check
	python3 setup.py check
}

package() {
	cd "$builddir"
	python2 setup.py install --prefix=/usr --root="$pkgdir"
	python3 setup.py install --prefix=/usr --root="$pkgdir"
}

_py() {
	local py=${subpkgname%%-*}
	local python="python${py#py}"
	depends="$python"
	case $py in
		py2) depends="$depends py-enum34";;
	esac
	pkgdesc="$pkgdesc ($python)"
	install_if="$pkgname=$pkgver-r$pkgrel $python"
	mkdir -p "$subpkgdir"/usr/lib
	mv "$pkgdir"/usr/lib/${python}* "$subpkgdir"/usr/lib/
}

sha512sums="56f0a796741b1a46bfe91e578dc76067b612d0041dd8b93043521c8e53827a5bcdd815f94e91d22d4ae9d13125bfb9012cb1c4660635e7cc93472141be504efb  py-hypothesis-4.14.3.tar.gz"
